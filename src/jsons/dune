(executable
 (name run_json)
 (modules run_json)
 (libraries lib yojson)
 (flags
  (:standard -rectypes))
 (preprocess
  (pps ppx_blob)))

(cram
 (deps
  run_json.exe
  test1.json
  test2.json
  test3.json
  run4.json
  test5.json
  ;guava.json
  ))

(rule
 (targets test1.json test2.json test3.json test5.json)
 (mode
  (promote (until-clean)))
 (deps ./make_JSONs.exe)
 (action
  (run ./make_JSONs.exe)))

(executable
 (name make_JSONs)
 (modules make_JSONs)
 (flags
  (:standard -rectypes))
 (libraries lib))
